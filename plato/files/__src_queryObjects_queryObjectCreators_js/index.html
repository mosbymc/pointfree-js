<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - ./src/queryObjects/queryObjectCreators.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/es-analysis/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>./src/queryObjects/queryObjectCreators.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">79.91</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">217</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">27.45</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">2.29</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">import { queryable } from &#039;./queryable&#039;;
import { orderedQueryable } from &#039;./orderedQueryable&#039;;
import { orderBy } from &#039;../projection/projectionFunctions&#039;;
import { defaultEqualityComparer, defaultPredicate, generatorProto } from &#039;../helpers&#039;;

function createNewQueryableDelegator(source, iterator) {
    var obj = Object.create(queryable);
    obj.dataComputed = false;
    obj.source = source;
    if (iterator &amp;&amp; generatorProto.isPrototypeOf(iterator))
        obj[Symbol.iterator] = iterator;

    obj.map = function _map(mapFunc) {
        return this.queryableMap(mapFunc);
    };
    obj.where = function _where(predicate) {
        return this.queryableWhere(predicate);
    };
    obj.concat = function _concat(collection) {
        return this.queryableConcat(collection);
    };
    obj.except = function _except(collection, comparer = defaultEqualityComparer) {
        return this.queryableExcept(collection, comparer);
    };
    obj.groupJoin = function _groupJoin(inner, outerSelector, innerSelector, projector, comparer = defaultEqualityComparer) {
        return this.queryableGroupJoin(inner, outerSelector, innerSelector, projector, comparer);
    };
    obj.intersect = function _intersect(collection, comparer = defaultEqualityComparer) {
        return this.queryableIntersect(collection, comparer);
    };
    obj.join = function _join(inner, outerSelector, innerSelector, projector, comparer = defaultEqualityComparer) {
        return this.queryableJoin(inner, outerSelector, innerSelector, projector, comparer);
    };
    obj.union = function _union(collection, comparer = defaultEqualityComparer) {
        return this.queryableUnion(collection, comparer);
    };
    obj.zip = function _zip(selector, collection) {
        return this.queryableZip(selector, collection);
    };
    //TODO: see if setting up a default value for the group/order comparer is a necessary thing
    obj.groupBy = function _groupBy(keySelector, comparer) {
        return this.queryableGroupBy(keySelector, comparer);
    };
    obj.groupByDescending = function _groupByDescending(keySelector, comparer) {
        return this.queryableGroupByDescending(keySelector, comparer);
    };
    obj.orderBy = function _orderBy(keySelector, comparer) {
        return this.queryableOrderBy(keySelector, comparer);
    };
    obj.orderByDescending = function _orderByDescending(keySelector, comparer) {
        return this.queryableOrderByDescending(keySelector, comparer);
    };
    obj.distinct = function _distinct(comparer = defaultEqualityComparer) {
        return this.queryableDistinct(comparer);
    };
    obj.flatten = function _flatten() {
        return this.queryableFlatten();
    };
    obj.flattenDeep = function _flattenDeep() {
        return this.queryableFlattenDeep();
    };
    obj.take = function _take(amt = 1) {
        return this.queryableTake(amt);
    };
    obj.takeWhile = function _takeWhile(predicate) {
        return this.queryableTakeWhile(predicate);
    };
    obj.skip = function _skip(amt = 1) {
        return this.queryableSkip(amt);
    };
    obj.skipWhile = function _skipWhile(predicate) {
        return this.queryableSkipWhile(predicate);
    };
    obj.any = function _any(predicate = defaultPredicate) {
        return this.queryableAny(predicate);
    };
    obj.all = function _all(predicate = defaultPredicate) {
        return this.queryableAll(predicate);
    };
    obj.first = function _first(predicate) {
        return this.queryableFirst(predicate);
    };
    obj.last = function _last(predicate) {
        return this.queryableLast(predicate);
    };
    return addGetter(obj);
}

function createNewOrderedQueryableDelegator(source, iterator, sortObj) {
    var obj = Object.create(orderedQueryable);
    obj.source = source;
    obj.dataComputed = false;
    obj._appliedSorts = sortObj;
    if (iterator &amp;&amp; generatorProto.isPrototypeOf(iterator))
        obj[Symbol.iterator] = iterator;

    obj.map = function _map(mapFunc) {
        return this.orderedMap(mapFunc);
    };
    obj.where = function _where(predicate) {
        return this.orderedWhere(predicate);
    };
    obj.concat = function _concat(collection) {
        return this.orderedConcat(collection);
    };
    obj.join = function _join(inner, outerSelector, innerSelector, projector, comparer = defaultEqualityComparer) {
        return this.orderedJoin(inner, outerSelector, innerSelector, projector, comparer);
    };
    obj.union = function _union(collection, comparer = defaultEqualityComparer) {
        return this.orderedUnion(collection, comparer);
    };
    obj.zip = function _zip(selector, collection) {
        return this.orderedZip(selector, collection);
    };
    obj.groupBy = function _groupBy(keySelector, comparer) {
        return this.queryableGroupBy(keySelector, comparer);
    };
    obj.groupByDescending = function _groupByDescending(keySelector, comparer) {
        return this.queryableGroupByDescending(keySelector, comparer);
    };
    obj.except = function _except(collection, comparer = defaultEqualityComparer) {
        return this.orderedExcept(collection, comparer);
    };
    obj.groupJoin = function _groupJoin(inner, outerSelector, innerSelector, projector, comparer = defaultEqualityComparer) {
        return this.queryableGroupJoin(inner, outerSelector, innerSelector, projector, comparer);
    };
    obj.intersect = function _intersect(collection, comparer = defaultEqualityComparer) {
        return this.orderedIntersect(collection, comparer);
    };
    obj.distinct = function _distinct(comparer = defaultEqualityComparer) {
        return this.orderedDistinct(comparer);
    };
    obj.flatten = function _flatten() {
        return this.queryableFlatten();
    };
    obj.flattenDeep = function _flattenDeep() {
        return this.queryableFlattenDeep();
    };
    obj.take = function _take(amt = 1) {
        return this.orderedTake(amt);
    };
    obj.takeWhile = function _takeWhile(predicate) {
        return this.orderedTakeWhile(predicate);
    };
    obj.skip = function _skip(amt = 1) {
        return this.orderedSkip(amt);
    };
    obj.skipWhile = function _skipWhile(predicate) {
        return this.orderedSkipWhile(predicate);
    };
    obj.any = function _any(predicate = defaultPredicate) {
        return this.orderedAny(predicate);
    };
    obj.all = function _all(predicate = defaultPredicate) {
        return this.orderedAll(predicate);
    };
    obj.first = function _first(predicate) {
        return this.orderedFirst(predicate);
    };
    obj.last = function _last(predicate) {
        return this.orderedLast(predicate);
    };

    //Shadow the orderBy/orderByDescending function of the delegate so that if another
    //orderBy/orderByDescending function is immediately chained to an orderedQueryable
    //delegator object, it will treat it as a thenBy/thenByDescending call respectively.
    //TODO: These could also be treated as no-ops, or a deliberate re-ordering of the
    //TODO: source; I feel the latter would be an odd thing do to, so it might not
    //TODO: make sense to treat it that way.

    //TODO: Rather than shadowing, I could make the queryable&#039;s orderBy/orderByDescending
    //TODO: functions check the context object&#039;s prototype; if it finds that the
    //TODO: orderedQueryable is in the context&#039;s prototype chain, then it could treat
    //TODO: the function call differently
    obj.orderBy = function _orderBy(keySelector, comparer) {
        return this.thenBy(keySelector, comparer);
    };

    obj.orderByDescending = function _orderByDescending(keySelector, comparer) {
        return this.thenByDescending(keySelector, comparer);
    };

    obj.thenBy = function _thenBy(keySelector, comparer) {
        var sortObj = this._appliedSorts.concat({ keySelector: keySelector, comparer: comparer, direction: &#039;asc&#039; });
        return createNewOrderedQueryableDelegator(this.source, orderBy(this, sortObj), sortObj);
    };

    obj.thenByDescending = function thenByDescending(keySelector, comparer) {
        var sortObj = this._appliedSorts.concat({ keySelector: keySelector, comparer: comparer, direction: &#039;desc&#039; });
        return createNewOrderedQueryableDelegator(this.source, orderBy(this, sortObj), sortObj);
    };

    return addGetter(obj);
}


function addGetter(obj) {
    return Object.defineProperty(
        obj,
        &#039;data&#039;, {
            get: function _data() {
                //TODO: not sure if I plan on &#039;saving&#039; the eval-ed data of a queryable object, and if I do, it&#039;ll take a different
                //TODO: form that what is currently here; for now I am going to leave the check for pre-eval-ed data in place
                if (!this.dataComputed) {
                    //TODO: is this valid for an object that has an iterator? Seems like it should work...
                    var res = Array.from(this);
                    this.dataComputed = true;
                    this.evaluatedData = res;
                    return res;
                }
                return this.evaluatedData;
            }
        }
    );
}

export { createNewQueryableDelegator, createNewOrderedQueryableDelegator };</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ cyclomatic }} <br>
    Length : {{ halstead.length }} <br>
    Difficulty : {{ halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
